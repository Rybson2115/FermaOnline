@model Experiment

<div class="container p-3">
    <div class="row pt-4">
        <a asp-action="Index" class="btn btn-primary btn-circle"><</a>
        <div class="card shadow mb-4">
            <div class="card-header py-3">
            <h2 class="text-primary">@Model.Name</h2>
            <a type="button" class="btn btn-primary col-6 text-right" asp-controller="Survey" asp-route-Id="@Model.Id" asp-action="Create">Add survey</a>
            </div>
            <div class="card-body">
                @{var TextSpecies = @Model.Status ? "This experiment is conduct on" : "This experiment was conducted on";
                    <p>@TextSpecies @Model.Species</p>
                }
            <p>id:@Model.Code </p>
                <p class="lh-base">@Html.Raw(@Model.Description)</p> 
            </div>
        </div>

    </div>
    <br />

    @if (Model.SurveysList.Count != 0)
    {
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Surveys</h6>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table ">
                        <thead> 
                            <tr>
                                <th>Data</th>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <th>@survey.SurveyDate.ToString("dd/MM/yyyy")</th>
                                }
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Cage</td>
                                @{ char[] alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".ToCharArray();
                                    @foreach (var survey in Model.SurveysList)
                                    {
                                        <td>
                                            <table class="table mb-0">
                                                <tr>
                                                    @for (int i = 0; i < Model.CageNumber; i++)
                                                    {
                                                    <td>@alphabet[i] </td>
                                                    }
                                                </tr>
                                            </table>
                                        </td>
                                    }
                                }
                            </tr>
                            <tr>
                                <td>Loculus quantity </td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.LoculusQuantity </td>
                                }
                            </tr>
                            <tr>
                                <td>Cage quantity </td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>
                                        <table class="table mb-0">
                                            <tr>
                                                @foreach (var cage in survey.Cages)
                                                {
                                                    <td>@cage.CageQuantity</td>
                                                }
                                            </tr>
                                        </table>
                                    </td>
                                }
                            </tr>
                            <tr>
                                <td>Group Weight </td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>
                                        <table class="table mb-0">
                                            <tr>
                                                @foreach (var cage in survey.Cages)
                                                {
                                                    <td>@cage.GroupWeight </td>
                                                }
                                            </tr>
                                        </table>
                                    </td>
                                }
                            </tr>
                            <tr>
                                <td>Days from first weight</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.DaysFromFirstWeight </td>
                                }
                            </tr>
                            <tr>
                                <td>Day Of Life</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.DayOfLife </td>
                                }
                            </tr>
                            <tr>
                                <td>Individual body weight </td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>
                                        <table class="table mb-0">
                                            <tr>
                                                @foreach (var cage in survey.Cages)
                                                {
                                                    <td>@cage.IndividualBodyWeight </td>
                                                }
                                            </tr>
                                        </table>
                                    </td>
                                }
                            </tr>
                            <tr>
                                <td>Average body weight</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.AverageBodyWeight </td>
                                }
                            </tr>
                            <tr>
                                <td>Difference in body weight </td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>
                                        <table class="table mb-0">
                                            <tr>
                                                @foreach (var cage in survey.Cages)
                                                {
                                                    <td>@cage.DifferenceInBodyWeight </td>
                                                }
                                            </tr>
                                        </table>
                                    </td>
                                }
                            </tr>
                            <tr>
                                <td>Weight gain from start </td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>
                                        <table class="table mb-0">
                                            <tr>
                                                @foreach (var cage in survey.Cages)
                                                {
                                                    <td>@cage.WeightGainFromStart </td>
                                                }
                                            </tr>
                                        </table>
                                    </td>

                                }
                            </tr>
                            <tr>
                                <td>Average weight gain</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.AverageWeightGainFromCages </td>
                                }
                            </tr>
                            <tr>
                                <td>Weight gain from last survey</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>
                                        <table class="table mb-0">
                                            <tr>
                                                @foreach (var cage in survey.Cages)
                                                {
                                                    <td>@cage.WeightGainFromLastSurvey </td>
                                                }
                                            </tr>
                                        </table>
                                    </td>
                                }
                            </tr>
                            <tr>
                                <td>Average weight gain from last survey</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.AverageWeightGainFromLastSurvey </td>
                                }
                            </tr>
                            <tr>
                                <td>Loculus feed intake</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.LoculusFeedInTake </td>
                                }
                            </tr>
                            <tr>
                                <td>Feed Intake Weekly</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.FeedIntakeWeekly </td>
                                }
                            </tr>
                            <tr>
                                <td>FeedIntakDaily</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.FeedIntakDaily </td>
                                }
                            </tr>
                            <tr>
                                <td>Feed Conversion Ratio</td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>@survey.FeedConversionRatio </td>
                                }
                            </tr>
                            <tr>
                                <td></td>
                                @foreach (var survey in Model.SurveysList)
                                {
                                    <td>  <a asp-controller="Survey" asp-action="Delete" asp-route-Id="@survey.SurveyId" class="btn btn-danger mx-1">Delete</a></td>

                                }

                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Bar Chart</h6>
            </div>
            <div class="card-body">
                <div class="chart-bar">
                    <div class="chartjs-size-monitor"><div class="chartjs-size-monitor-expand"><div class=""></div></div><div class="chartjs-size-monitor-shrink"><div class=""></div></div></div>
                    <canvas id="myChart" width="620" height="400" style="display: block; height: 320px; width: 496px;" class="chartjs-render-monitor"></canvas>
                </div>
                <hr>
                BioDose 2020
            </div>
        </div>



        <script>
            var chartdata = [];

         @foreach (var days in Model.SurveysList)
         {
              @: chartdata.push(@days.AverageBodyWeight);
        }


            var data = {
                labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
                datasets: [{
                    label: "Dataset #1",
                    backgroundColor: "rgba(255,99,132,0.2)",
                    borderColor: "rgba(255,99,132,1)",
                    borderWidth: 2,
                    hoverBackgroundColor: "rgba(255,99,132,0.4)",
                    hoverBorderColor: "rgba(255,99,132,1)",
                    data: [65, 59, 20, 81, 56, 55, 40],
                }]
            };

            var options = {
                maintainAspectRatio: false,
                scales: {
                    yAxes: [{
                        stacked: true,
                        gridLines: {
                            display: true,
                            color: "rgba(255,99,132,0.2)"
                        }
                    }],
                    xAxes: [{
                        gridLines: {
                            display: false
                        }
                    }]
                }
            };

            Chart.Bar('myChart', {
                options: options,
                data: data
            });

        </script>
    }


    @foreach (var img in @Model.Images)
    {

        <p>@img.FileName"</p>
        // <img src="~/img/ExperimentImages/@img.FileName" alt="@img.FileName" />

    }
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Images</h6>
        </div>
        <div class="card-body">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="~/img/undraw_profile_1.svg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="~/img/undraw_profile_2.svg" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="~/img/undraw_profile_3.svg" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
    </div>
</div>

